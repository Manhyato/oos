<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<nav class="navbar">
    <div class="navbar-content">
        <a href="/" class="navbar-brand">üçï –ü–∏—Ü—Ü–µ—Ä–∏—è</a>
        <div class="navbar-links">
            <a href="/">–ú–µ–Ω—é</a>
            <a href="/orders/track">–û—Ç—Å–ª–µ–¥–∏—Ç—å –∑–∞–∫–∞–∑</a>
            <a href="/admin/orders">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
        </div>
    </div>
</nav>

<div class="container">
    <div class="card">
        <h1 class="card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h1>

        <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

        <div th:if="${waitingOrders != null && !waitingOrders.isEmpty()}" class="mb-3">
            <h3>–ó–∞–∫–∞–∑—ã, –æ–∂–∏–¥–∞—é—â–∏–µ –∫—É—Ä—å–µ—Ä–∞</h3>
            <div class="alert alert-info">
                –ï—Å—Ç—å <strong th:text="${waitingOrders.size()}"></strong> –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –±–µ–∑ –∫—É—Ä—å–µ—Ä–∞
                <a href="/admin/delivery" class="btn btn-primary" style="margin-left: 1rem;">–ù–∞–∑–Ω–∞—á–∏—Ç—å –∫—É—Ä—å–µ—Ä–æ–≤</a>
            </div>
        </div>

        <div class="mb-2" style="display:flex; justify-content: space-between; align-items:center;">
            <h3>–í—Å–µ –∑–∞–∫–∞–∑—ã</h3>
            <div>
                <a href="/admin/menu" class="btn btn-secondary" style="margin-right:0.5rem;">–ú–µ–Ω—é</a>
                <a href="/admin/reports" class="btn btn-primary" style="margin-right:0.5rem;">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã</a>
                <button class="btn btn-secondary" onclick="adminLogout()">–í—ã–π—Ç–∏</button>
            </div>
        </div>
        <table class="table">
            <thead>
            <tr>
                <th>ID</th>
                <th>–ö–ª–∏–µ–Ω—Ç</th>
                <th>–ê–¥—Ä–µ—Å</th>
                <th>–°—É–º–º–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–û–ø–ª–∞—á–µ–Ω</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="order : ${orders}">
                <td th:text="${order.id}"></td>
                <td th:text="${order.client != null ? order.client.fullName : '‚Äî'}"></td>
                <td th:text="${order.address != null ? order.address : '‚Äî'}"></td>
                <td th:text="${order.totalAmount != null ? #numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 2, 'POINT') + ' ‚ÇΩ' : '0 ‚ÇΩ'}"></td>

                <td>
                    <select class="form-control" th:value="${order.status}" 
                            th:attr="data-order-id=${order.id},data-status-select='true'">
                        <option value="NEW">NEW</option>
                        <option value="PAID">PAID</option>
                        <option value="DELIVERY_ASSIGNED">DELIVERY_ASSIGNED</option>
                        <option value="DELIVERED">DELIVERED</option>
                    </select>
                    <small class="order-status-text" th:text="${order.status != null ? order.status : '‚Äî'}"></small>
                </td>

                <td>
                    <span th:if="${order.paid}" class="status-badge status-paid paid-badge">–î–∞</span>
                    <span th:unless="${order.paid}" class="status-badge status-new paid-badge">–ù–µ—Ç</span>
                </td>

                <td>
                    <a th:href="@{'/admin/orders/' + ${order.id}}" class="btn btn-secondary">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script th:src="@{/js/main.js}"></script>
<script th:src="@{/js/admin-auth.js}"></script>
<script th:src="@{/js/admin-orders.js}"></script>
</body>
</html>


