<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="navbar-brand">üçï –ü–∏—Ü—Ü–µ—Ä–∏—è</a>
            <div class="navbar-links">
                <a href="/">–ú–µ–Ω—é</a>
                <a href="/orders/track">–û—Ç—Å–ª–µ–¥–∏—Ç—å –∑–∞–∫–∞–∑</a>
                <a href="/admin/orders">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="card">
            <h1 class="card-title">–ó–∞–∫–∞–∑ #<span th:text="${order.id}"></span></h1>

            <div class="mb-3">
                <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> <span th:text="${order.client != null ? order.client.fullName : '‚Äî'}"></span></p>
                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span th:text="${order.client != null ? order.client.phone : '‚Äî'}"></span></p>
                <p><strong>–ê–¥—Ä–µ—Å:</strong> <span th:text="${order.address != null ? order.address : '‚Äî'}"></span></p>
                <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong>
                    <span th:if="${order.createdAt != null}" th:text="${#temporals.format(order.createdAt, 'dd.MM.yyyy HH:mm')}"></span>
                    <span th:unless="${order.createdAt != null}">‚Äî</span>
                </p>
                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> 
                    <span class="status-badge" 
                          th:classappend="${order.status == T(ru.sspo.oos.model.OrderStatus).NEW} ? 'status-new' : 
                                         (order.status == T(ru.sspo.oos.model.OrderStatus).PAID) ? 'status-paid' :
                                         (order.status == T(ru.sspo.oos.model.OrderStatus).DELIVERING || order.status == T(ru.sspo.oos.model.OrderStatus).DELIVERY_ASSIGNED) ? 'status-delivering' :
                                         'status-delivered'}"
                          th:text="${order.status}"></span>
                </p>
                <p th:if="${order.courier}"><strong>–ö—É—Ä—å–µ—Ä:</strong> <span th:text="${order.courier.name}"></span></p>
            </div>

            <h3>–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:</h3>
            <div th:if="${order.items == null || order.items.isEmpty()}" class="alert alert-info">
                –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.
            </div>
            <table th:if="${order.items != null && !order.items.isEmpty()}" class="table">
                <thead>
                    <tr>
                        <th>–ü–∏—Ü—Ü–∞</th>
                        <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                        <th>–¶–µ–Ω–∞</th>
                        <th>–°—É–º–º–∞</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item : ${order.items}">
                        <td th:text="${item.pizza != null && item.pizza.name != null ? item.pizza.name : '‚Äî'}"></td>
                        <td th:text="${item.quantity != null ? item.quantity : '‚Äî'}"></td>
                        <td th:text="${item.pizza != null && item.pizza.price != null ? #numbers.formatDecimal(item.pizza.price, 0, 'COMMA', 2, 'POINT') + ' ‚ÇΩ' : '‚Äî'}"></td>
                        <td th:text="${item.price != null ? #numbers.formatDecimal(item.price, 0, 'COMMA', 2, 'POINT') + ' ‚ÇΩ' : '‚Äî'}"></td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3"><strong>–ò—Ç–æ–≥–æ:</strong></td>
                        <td><strong th:text="${order.totalAmount != null ? #numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 2, 'POINT') + ' ‚ÇΩ' : '‚Äî'}"></strong></td>
                    </tr>
                </tfoot>
            </table>

            <div class="mt-3">
                <a th:if="${!order.paid}" th:href="@{'/orders/' + ${order.id} + '/payment'}" class="btn btn-success">
                    –û–ø–ª–∞—Ç–∏—Ç—å –∑–∞–∫–∞–∑
                </a>
                <a th:if="${order.paid}" th:href="@{'/orders/' + ${order.id} + '/receipt'}" class="btn btn-secondary">
                    –û—Ç–∫—Ä—ã—Ç—å —á–µ–∫
                </a>
            </div>
        </div>
    </div>

    <script th:src="@{/js/main.js}"></script>
</body>
</html>

