<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="navbar-brand">üçï –ü–∏—Ü—Ü–µ—Ä–∏—è</a>
            <div class="navbar-links">
                <a href="/">–ú–µ–Ω—é</a>
                <a href="/orders/track">–û—Ç—Å–ª–µ–¥–∏—Ç—å –∑–∞–∫–∞–∑</a>
                <a href="/admin/orders">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="card">
            <h1 class="card-title">–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #<span th:text="${order.id}"></span></h1>

            <div class="mb-3">
                <p><strong>–°—É–º–º–∞ –∫ –æ–ø–ª–∞—Ç–µ:</strong> <span th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 2, 'POINT')} + ' ‚ÇΩ'"></span></p>
                <p><strong>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> <span th:text="${order.address}"></span></p>
            </div>

            <form id="paymentForm" onsubmit="processPayment(event)">
                <div class="form-group">
                    <label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã *</label>
                    <select id="paymentMethod" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</option>
                        <option value="CARD">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</option>
                        <option value="CASH">–ù–∞–ª–∏—á–Ω—ã–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</option>
                    </select>
                </div>

                <div id="errorMessage" class="alert alert-error hidden"></div>
                <div id="successMessage" class="alert alert-success hidden"></div>

                <button type="submit" class="btn btn-success" style="width: 100%;" 
                        th:disabled="${order.paid}">
                    <span th:if="${order.paid}">–ó–∞–∫–∞–∑ —É–∂–µ –æ–ø–ª–∞—á–µ–Ω</span>
                    <span th:unless="${order.paid}">–û–ø–ª–∞—Ç–∏—Ç—å</span>
                </button>
            </form>

            <div th:if="${order.paid}" class="alert alert-success mt-2">
                –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ–ø–ª–∞—á–µ–Ω!
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        const orderId = /*[[${order.id}]]*/ null;
        const isPaid = /*[[${order.paid}]]*/ false;
    </script>
    <script th:src="@{/js/main.js}"></script>
    <script th:src="@{/js/payment.js}"></script>
</body>
</html>

